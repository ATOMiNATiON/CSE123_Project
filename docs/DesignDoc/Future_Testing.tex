\newpage
\begin{samepage}
    \section{Manufactured Product Testing}
    \subsection{Common Scenarios (Tests 1–10)}
    % ---------------------------- Test 1 --------------------------------
    \subsection*{1. Valid PIN Entry Test}
    \subparagraph{Test Goals and Purpose}
    \begin{itemize}
        \item Verify that a recognized 4-digit PIN unlocks the door without unnecessary delay.
        \item Check that the system logs this event as a successful access in Firestore.
    \end{itemize}
    \subparagraph{How We Test It}
    \begin{enumerate}
        \item Select a PIN known to be valid from the internal list.
        \item Enter the PIN once on the keypad.
        \item Observe the system's response, checking for physical bolt movement and UI changes on the mobile application.
        \item Look for updates to the (\texttt{LOCK\_STATE}) value in Firestore.
    \end{enumerate}
    
    \textbf{Expectations of Test}
    \begin{center}
    \begin{tabular}{|c|p{10cm}|}
      \hline
      \textbf{Result} & \textbf{Conditions} \\
      \hline
      PASS & Bolt retracts within \textless{}0.5\,s; \texttt{LOCK\_STATE}=1; Firestore log entry \emph{success}. \\
      \hline
      FAIL & Any deviation from the above timing, state, or logging behaviour. \\
      \hline
    \end{tabular}
    \end{center}
\end{samepage}


% ---------------------------- Test 2 --------------------------------
\newpage
\subsection*{2. Invalid PIN Lockout Test}
\subparagraph{Test Goals and Purpose}
\begin{itemize}
    \item Ensure the system prevents further PIN attempts after multiple consecutive failures.
    \item Lock should be shut down for a short expiration period.
    \item Confirm some form of lockout indication is presented, such as a light or warning beep.
    \item Owner's phoone should receive an alert about the failed attempts.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Enter three clearly incorrect PINs in under 30 seconds.
    \item Observe for a visible or audible signal.
    \item Confirm that \texttt{LOCKOUT\_COUNT} has risen and \texttt{LOCK\_STATE} is still 0 (locked).
\end{itemize}
\subparagraph{Expectations of Test}
\begin{center}
\begin{tabular}{|c|p{10cm}|}
  \hline
  \textbf{Result} & \textbf{Conditions} \\
  \hline
  \textbf{PASS} &
    \begin{minipage}[t]{\linewidth}
    \begin{itemize}
      \item Keypad flashes red and/or beeps immediately after the \textbf{third} wrong entry.
      \item No further PINs are accepted for the lockout period (default: 60 s).
      \item Mobile app log shows “3 invalid PIN attempts – lock is temporarily disabled” within 5 s.
      \item Firestore records \texttt{LOCKOUT\_COUNT = 3} and \texttt{LOCK\_STATE = 0}.\\
    \end{itemize}
    \end{minipage} \\ 
  \hline
  \textbf{FAIL} & Any one of the PASS conditions is missing or incorrect. \\ 
  \hline
\end{tabular}
\end{center}
\vspace{0.5em}

\noindent\textbf{Reset after the test:}  
Either wait for the lockout timer to expire or enter an admin PIN to clear the lockout so the next test starts from a clean state.\\


% ---------------------------- Test 3 --------------------------------
\newpage
\begin{samepage}
    \subsection*{3. Emergency PIN Test}
    \subparagraph{Test Goals and Purpose}
    \begin{itemize}
        \item Verify that a designated emergency PIN can override an active lockout state.
        \item Ensure that using the emergency PIN resets lockout counters and restores normal operation.
        \item Confirm the system logs the emergency unlock event.
    \end{itemize}
    \subparagraph{How We Test It}
    \begin{itemize}
        \item Trigger a lockout by intentionally inputting three incorrect PIN entries.
        \item Confirm after each incorrect PIN attempt (\texttt{LOCK\_STATE} = 1).
        \item Immediately enter the emergency PIN once the lockout state is active.
        \item Observe the lock mechanism (it should retract).
        \item Monitor Firestore to verify an EMERGENCY\_UNLOCK entry is created.
        \item Owner's phone should be notified and the mobile application should display that the emergency PIN was used.
        \item In Firestore, confirm that \texttt{LOCKOUT\_COUNT} resets to 0 and \texttt{LOCK\_STATE} becomes 1.
    \end{itemize}
    \subparagraph{Expectations of Test}
    \begin{center}
    \begin{tabular}{|c|p{10cm}|}
      \hline
      \textbf{Result} & \textbf{Conditions} \\
      \hline
      \textbf{PASS} &
        \begin{minipage}[t]{\linewidth}
        \begin{itemize}
          \item Door unlocks immediately upon entering the emergency PIN.
          \item \texttt{LOCKOUT\_COUNT} is reset to 0 and \texttt{LOCK\_STATE = 1} in Firestore.
          \item Mobile app shows “Emergency unlock used” notification within 5 s.
          \item Firestore contains a new \texttt{EMERGENCY\_UNLOCK} event entry. \\
        \end{itemize}
        \end{minipage} \\
      \hline
      \textbf{FAIL} & Any one of the PASS conditions is missing or incorrect. \\
      \hline
    \end{tabular}
    \end{center}
    
    \vspace{0.5em}
    
    \noindent\textbf{Reset after the test:}  
    Re-lock the door with a valid standard PIN to prepare for the next test.\\
    
\end{samepage}

% ---------------------------- Test 4 --------------------------------
\newpage
\begin{samepage}
    \subsection*{4. OTP Entry Test}

    \subparagraph{Test Goals and Purpose}
    \begin{itemize}
        \item Confirm that a one-time password (OTP) generated by the mobile app unlocks the door as intended.
        \item Verify that each OTP is valid only for a short, predefined window (default: 5 minutes).
        \item Ensure the system rejects expired or reused OTPs.
        \item Check that the OTP event is recorded in Firestore with its timestamp and status.
    \end{itemize}

    \subparagraph{How We Test It}
    \begin{itemize}
        \item Open the mobile app and request a fresh OTP. Note the timestamp displayed (e.g., “Valid until 14:35”).
        \item On the keypad, enter the exact OTP digits within 5 minutes of generation.
        \item Observe the lock: it should retract immediately upon correct entry.
        \item In the app (or Firebase console), confirm:
        \begin{itemize}
            \item The OTP record appears with status “used” and a timestamp matching the entry time.
            \item \texttt{LOCK\_STATE} flips to 1 (unlocked) and an \texttt{OTP\_UNLOCK} event is logged.
        \end{itemize}
        \item Wait for 6 minutes (so the original OTP expires), then try entering the same OTP again.
        \item Observe that the lock remains closed and Firestore logs an \texttt{OTP\_EXPIRED} attempt.
    \end{itemize}

    \subparagraph{Expectations of Test}
    \begin{center}
    \begin{tabular}{|c|p{10cm}|}
      \hline
      \textbf{Result} & \textbf{Conditions} \\
      \hline
      \textbf{PASS} &
        \begin{minipage}[t]{\linewidth}
        \begin{itemize}
            \item Correct OTP (within 5 minutes) causes the bolt to retract and \texttt{LOCK\_STATE} becomes 1.
          \item Firestore logs an \texttt{OTP\_UNLOCK} event with the correct timestamp.
          \item Upon reusing the same OTP after expiration ( ~5 minutes), the lock stays locked.
          \item Firestore logs an \texttt{OTP\_EXPIRED} event, indicating rejection.\\
        \end{itemize}
        \end{minipage} \\
    \hline
      \textbf{FAIL} & Any one of the PASS conditions is missing or incorrect. \\ 
      \hline
    \end{tabular}
    \end{center}
\end{samepage}

% ---------------------------- Test 5 --------------------------------
\newpage
\subsection*{5. OTP Expiry Test}

\subparagraph{Test Goals and Purpose}
\begin{itemize}
    \item Ensure that once an OTP’s valid window (default: 5 minutes) has passed, it can no longer unlock the door.
    \item Confirm that the user receives a clear “OTP expired” message on the app or keypad display.
    \item Verify Firestore logs the expired‐OTP attempt with a timestamp and status “OTP\_EXPIRED.”
\end{itemize}

\subparagraph{How We Test It}
\begin{itemize}
    \item In the mobile app, request a new OTP and note its expiration time (e.g., “Valid until 14:35”).
    \item Wait for at least 6 minutes so that the original OTP has definitely expired.
    \item At the keypad, enter the exact same OTP digits that were generated earlier.
    \item Observe the lock: it should remain locked and may flash a message like “OTP expired.”
    \item In Firestore (or the app’s log), confirm:
    \begin{itemize}
        \item An \texttt{OTP\_EXPIRED} event appears with the correct timestamp.
        \item \texttt{LOCK\_STATE} remains 0 (locked).
    \end{itemize}
\end{itemize}

\subparagraph{Expectations of Test}
\begin{center}
\begin{tabular}{|c|p{10cm}|}
  \hline
  \textbf{Result} & \textbf{Conditions} \\
  \hline
  \textbf{PASS} &
    \begin{minipage}[t]{\linewidth}
    \begin{itemize}
        \item Entering an expired OTP does not cause the bolt to retract—\texttt{LOCK\_STATE} stays 0.
      \item App or keypad displays “OTP expired” immediately when the code is entered.
      \item Firestore logs a new \texttt{OTP\_EXPIRED} event with a timestamp matching the attempt.\\
    \end{itemize}
    \end{minipage} \\
  \hline
  \textbf{FAIL} & Any one of the PASS conditions is missing or incorrect. \\ 
  \hline
\end{tabular}
\end{center}

\vspace{0.5em}

% ---------------------------- Test 6 --------------------------------
\newpage
\begin{samepage}
    \subsection*{6. Rapid Wrong PIN Alarm Test}
    
    \subparagraph{Test Goals and Purpose}
    \begin{itemize}
        \item Verify that multiple quick incorrect PIN entries trigger an audible alarm.
        \item Ensure the lock remains locked during the alarm state and does not unlock.
        \item Confirm the alarm stops after a set timeout or when a correct PIN is entered.
        \item Check that each failed attempt and the alarm event are logged in Firestore.
    \end{itemize}
    
    \subparagraph{How We Test It}
    \begin{itemize}
        \item Enter \textbf{five} incorrect 4-digit PINs within 10 seconds.
        \item Listen for the alarm sound and observe that \texttt{LOCK\_STATE} remains 0 (locked).
        \item After the alarm has sounded for at least 30 seconds, enter a valid PIN.
        \item In Firestore, confirm:
        \begin{itemize}
            \item Each of the five wrong PIN attempts is recorded.
            \item An “ALARM\_TRIGGERED” event appears when the alarm starts.
            \item A “ALARM\_RESET” or “UNLOCK” event appears once the correct PIN silences the alarm and unlocks the door.
        \end{itemize}
    \end{itemize}

    \subparagraph{Expectations of Test}
    \begin{center}
    \begin{tabular}{|c|p{10cm}|}
      \hline
      \textbf{Result} & \textbf{Conditions} \\
      \hline
      \textbf{PASS} &
        \begin{minipage}[t]{\linewidth}
        \begin{itemize}
            \item An audible alarm sounds immediately after the \textbf{fifth} wrong entry.
            \item \texttt{LOCK\_STATE} remains 0 as the alarm sounds.
            \item Firestore logs five “PIN\_FAILED” events and one “ALARM\_TRIGGERED” event.
            \item Entering a correct PIN during or after the alarm stops the alarm and changes \texttt{LOCK\_STATE} to 1.
            \item Firestore logs an “ALARM\_RESET” (or “UNLOCK”) event matching the unlock time.\\
        \end{itemize}
        \end{minipage} \\
      \hline
      \textbf{FAIL} & Any one of the PASS conditions is missing or incorrect. \\ 
      \hline
    \end{tabular}
    \end{center}

    \vspace{0.5em}
    
    \noindent\textbf{Reset after the test:}  
    Wait for the alarm to clear automatically or enter a valid PIN to silence it and lock the door so the lock is ready for the next test.\\
\end{samepage}


% ---------------------------- Test 7 --------------------------------
\newpage
\begin{samepage}
\subsection*{7. Concurrent Unlock Command Test}

\subparagraph{Test Goals and Purpose}
\begin{itemize}
    \item Verify that when two authorized devices send unlock requests nearly simultaneously, the lock handles them without false errors or multiple bolt actuations.
    \item Ensure only one mechanical unlock occurs, even if multiple API calls arrive within a very short window.
    \item Confirm both unlock requests and their respective timestamps are recorded in Firestore.