\newpage
\section{Edge Case Test Plan}

\subsection*{Common Scenarios (Tests 1–5)}

\subsection*{1. Valid PIN Entry Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Check that entering a correct 4-digit PIN immediately unlocks the door.
    \item Make sure the system records the success.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Enter a valid PIN from the list.
    \item Observe if LOCK\_STATE is set to 1 in Firestore.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Bolt pulls back within 0.5 s of entering PIN.
    \item Firestore shows LOCK\_STATE = 1.
    \item No errors in the logs.
\end{itemize}

\subsection*{2. Invalid PIN Lockout Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Ensure three wrong PINs in 30 s locks out further tries.
    \item Check that an alarm or light indicates lockout.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Enter three different invalid PINs quickly.
    \item Check LOCKOUT\_COUNT and look for alarm.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item No PIN entries accepted for 60 s.
    \item Alarm or LED shows lockout.
    \item Firestore logs all failed attempts and the lockout event.
\end{itemize}

\subsection*{3. Emergency PIN Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Confirm that a special emergency PIN still works after lockout.
    \item Make sure normal lockout resets after emergency use.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Lock out with wrong PINs, then enter the emergency PIN.
    \item Check Firestore for an EMERGENCY\_UNLOCK record.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Door unlocks right away.
    \item Firestore logs the emergency unlock.
    \item Lockout counter resets.
\end{itemize}

\subsection*{4. OTP Entry Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Verify that a one-time code from the app unlocks the door.
    \item Make sure the code is sent and checked securely.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Request an OTP that’s valid for 5 min.
    \item Enter it on the keypad.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Firestore stores the OTP and its expiry time.
    \item Valid OTP unlocks the door.
    \item Invalid or expired OTP is rejected.
\end{itemize}

\subsection*{5. OTP Expiry Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Check that entering the OTP after it expires does not unlock.
    \item Show a message saying “OTP expired.”
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Wait until after 5 min expiry.
    \item Enter the same OTP on the keypad.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Door stays locked.
    \item Firestore logs “OTP\_EXPIRED.”
    \item App shows “OTP expired.”
\end{itemize}

\newpage
\subsection*{Less Common Scenarios (Tests 31–35)}

\subsection*{31. Multi-factor Auth Proximity Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Make sure PIN + Bluetooth both work together for unlock.
    \item See what happens if Bluetooth disconnects during entry.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Enter a valid PIN while moving phone out of Bluetooth range.
    \item Check logs for separate PIN and BLE events.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Door only opens if both PIN and BLE are OK.
    \item Firestore shows which factor failed if it doesn’t open.
\end{itemize}

\subsection*{32. Time-zone Mismatch Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Test OTP and scheduled lock when phone and lock have different clocks.
    \item Make sure times sync up correctly.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Set phone to PST, lock to UTC.
    \item Generate OTP and try it.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item OTP still works within the correct window.
    \item Auto-lock happens at the right local time.
\end{itemize}

\subsection*{33. DST Transition Auto-lock Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Check auto-lock around daylight-saving time changes.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Schedule auto-lock at 2 AM on DST change day.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Only one auto-lock event, no skips or doubles.
\end{itemize}

\subsection*{34. Admin vs. Guest Role Change Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Make sure changing a PIN’s role (admin/guest) updates immediately.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Change PIN role in Firestore and try using both roles.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Lock enforces the new role right away.
\end{itemize}

\subsection*{35. BLE Range Boundary Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item See if Bluetooth unlock works at the edge of its range (~5 m).
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Move phone from 1 m to 6 m away in 0.5 m steps.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Unlocks when signal is strong enough, fails when it’s too weak.
\end{itemize}

\newpage
\subsection*{Rare Scenarios (Tests 61–65)}

\subsection*{61. Cosmic Ray Bit-Flip Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Simulate random bit errors in memory to check stability.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Inject bit-flips in RAM/flash every 10 s.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item System catches or corrects errors, stays stable.
\end{itemize}

\subsection*{62. Lightning Surge Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Test surge protection by sending a voltage spike.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Apply a 1 kV pulse on the 12 V input for 1 µs.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item No damage, system recovers normally.
\end{itemize}

\subsection*{63. Seismic Vibration Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Make sure the lock survives shaking and vibration.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Run a 5–50 Hz vibration sweep at 0.5 g for 10 min.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item No loose parts, sensors stay stable, lock/unlock still works.
\end{itemize}

\subsection*{64. Extreme Cold Operation Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Verify lock works at minus 40 °C.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Put the lock in a minus 40 °C chamber for 2 h and do 10 cycles.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item Bolt moves on time, no cracking, battery holds up.
\end{itemize}

\subsection*{65. Extreme Heat Operation Test}
\subparagraph{What We’re Testing}
\begin{itemize}
    \item Check lock at +85 °C over 2 h.
\end{itemize}
\subparagraph{How We Test It}
\begin{itemize}
    \item Run lock/unlock every 5 min in the heat chamber.
\end{itemize}
\subparagraph{What We Expect}
\begin{itemize}
    \item MCU stays safe, no shutdowns, data intact.
\end{itemize}
